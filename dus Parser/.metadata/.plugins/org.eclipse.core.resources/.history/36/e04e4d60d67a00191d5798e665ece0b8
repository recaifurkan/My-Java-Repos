package com.byrfb.parser;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Iterator;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import com.byrfb.objects.Kontenjan;

public class ParserMain {

	public static void main(String[] args) throws IOException {
		File input = new File("assets/minmax(genel)05112018_4.xlsx");
		FileInputStream fis = new FileInputStream(input);
		
		ArrayList<Kontenjan> kontenjans = new ArrayList<Kontenjan>();

		XSSFWorkbook workBook = new XSSFWorkbook(fis);
		XSSFSheet sheet = workBook.getSheetAt(0);
		sheet.setRowBreak(332);
		Iterator<Row> rowIterator = sheet.iterator();

		while (rowIterator.hasNext()) {

			Row row = rowIterator.next();
			Iterator<Cell> cellIterator = row.cellIterator();
			int col = 0;
			
//			System.out.println(cell);
			Kontenjan kont = new Kontenjan();
			while (cellIterator.hasNext()) {
				Cell cell = cellIterator.next();
				if(cell.toString().equals("---")) {
					col++;
					continue;
				}
				if (col == 5)
					break;
				
				switch (col) {
				case 0:
					String unFakBras = cell.toString();
					String[] splittinCell = unFakBras.split("/");
					kont.setUniversite(splittinCell[0]);
					kont.setFakulte(splittinCell[1]);
					kont.setBrans(splittinCell[2]);
					
					break;
				case 1:
					kont.setKontenjanSayisi(Float.parseFloat(cell.toString().replace(",", ".")));
					break;
				case 2:
					kont.setYerlesen(Float.parseFloat(cell.toString().replace(",", ".").replace("*", "")));
					break;
				case 3:
					kont.setBosKontenjan(Float.parseFloat(cell.toString().replace(",", ".")));
					break;
				case 4:
					kont.setEnKucuk( Float.parseFloat(cell.toString().replace(",", ".")));
					break;
				case 5:
					kont.setEnBuyuk(Float.parseFloat(cell.toString().replace(",", ".")));
					break;

				default:
					break;
				}
				
				
				col++;
				

			}
			System.out.println(kont);
			kontenjans.add(kont);

		}

		fis.close();

	}

}
